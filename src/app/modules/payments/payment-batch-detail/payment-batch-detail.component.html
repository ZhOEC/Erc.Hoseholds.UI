<ng-container *ngIf="paymentsBatch as pb">
  <h3>Пачка - {{ pb.name ? pb.name : 'xxxxxxx' }}</h3>
  <nz-descriptions nzBordered nzSize="small">
    <nz-descriptions-item nzTitle="Канал:">{{ pb.paymentChannelName }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Дата:">{{ pb.incomingDate | date: dateFormat }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Кількість платежів:">{{ pb.totalCount }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Сума:">{{ pb.totalAmount }}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Статус:">{{ pb.isClosed ? 'Закрита' : 'Відкрита' }}</nz-descriptions-item>
  </nz-descriptions>
</ng-container>

<ng-template #titleTemplate>
  <nz-row nzJustify="space-between" nzAlign="middle" nzGutter="12">
    <nz-col>
      <span>Список платежів</span>
    </nz-col>
    <nz-col>
      <nz-space [nzSize]="8">
        <nz-space-item>
          <label nz-checkbox [(ngModel)]="showProcessedPayments" (ngModelChange)="onChangedShowProcessedPayments($event)">Показувати оброблені</label>
        </nz-space-item>
        <nz-space-item>
          <button nz-button nzType="primary" (click)="openPaymentDialog()">Додати</button>
        </nz-space-item>
      </nz-space>
    </nz-col>
  </nz-row>
</ng-template>
<nz-table #paymentsTable 
  [nzData]="paymentList"
  [nzFrontPagination]="false"
  [nzTotal]="totalCount"
  [nzPageSize]="pageSize"
  [nzPageIndex]="pageNumber"
  [nzShowSizeChanger]="true"
  [nzLoading]="isLoading"
  [nzTitle]="titleTemplate"
  [nzFooter]="totalCount ? 'Всього: ' + totalCount : null"
  nzSize="small"
  nzBordered>
  <thead>
    <tr>
      <th>Id</th>
      <th>Точка обліку</th>
      <th>Інформація про абонента</th>
      <th>Дата платежу</th>
      <th>Сума</th>
      <th>Тип</th>
      <th>Статус</th>
      <th>Помилка</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let p of paymentsTable.data">
      <td>{{ p.id }}</td>
      <td>{{ p.accountingPointName }}</td>
      <td>{{ p.payerInfo }}</td>
      <td>{{ p.payDate | date: dateFormat }}</td>
      <td>{{ p.amount }}</td>
      <td>{{ p.status }}</td>
      <td>{{ p.type }}</td>
      <td></td>
    </tr>
  </tbody>
</nz-table>

<app-payment-modal></app-payment-modal>
